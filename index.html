<!DOCTYPE html>
<html lang="en">
    <head>
        <title>xrView</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

        <style>
            #qrcode {
                background: white;
                padding: 10px;
                width: fit-content;
            }
        </style>

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
    </head>
    <body style="margin: 0px; position: fixed;">

        <script type="importmap">
            {
                "imports": {
                    "three": "https://cdn.jsdelivr.net/npm/three@0.175.0/build/three.module.js",
                    "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.175.0/examples/jsm/"
                }
            }
        </script>

        <article style="position: absolute; max-height: 100%; max-width: 700px; overflow-y: scroll;">
            <h1>xrView</h1>
            <p>
                <small>By Joakim Bohlin, Infravis</small>
            </p>
            <p>Open this page from the browser inside a compatible XR headset (e.g. Meta Quest) and click "Start XR".</p>
            <details>
                <summary role="button" class="outline secondary">Loading 3D models</summary>
                <article>
                    <p>You have three options to load models:
                        <ul>
                            <li>Use URL parameters (<a href=".">Reset</a>):
                                <ul>
                                    <li><a href="./?modelPath=https%3A%2F%2Fthreejs.org%2Fexamples%2Fmodels%2Fgltf%2FHorse.glb&scale=0.01&position=0.75%2C0%2C0&modelPath=https%3A%2F%2Fthreejs.org%2Fexamples%2Fmodels%2Fgltf%2FFlamingo.glb&scale=0.011&position=-0.75%2C1.5%2C0">Horse and flamingo</a></li>
                                    <li><a href="./?modelPath=https://raw.githubusercontent.com/gunterAlce/webar-tutorial/main/a1m.glb&scale=0.01&position=0,1,0">Protein</a></li>
                                    <li><a href="./?modelPath=https://raw.githubusercontent.com/gunterAlce/webar-tutorial/main/microFos3.glb&scale=5&position=0,1,0">Microfossil</a></li>
                                </ul>
                            </li>
                            <li>Use the web console: <pre>addModel(url, scale, position, quaternion)</pre></li>
                            <li>Upload one or more glTF/glb files here: <input id="modelInput" type="file" accept=".gltf, .glb" multiple>
                            </li>
                        </ul>
                    </p>
                    <p>
                        Click a loaded model to transform it. Double-click to switch transformation mode. In a supported headset, use your hands to grab and transform.
                    </p>
                </article>
            </details>
            <details>
                <summary role="button" class="outline secondary">Sync</summary>
                <article>

                    <p>
                        Sync the scene between different devices using peer-to-peer
                        connections. For example, this can be used to send data
                        between a computer and a VR headset.
                    </p>
                    <p>
                        To connect to this instance, open the link below
                        on the other device. Instead of typing the whole id
                        into a headset, it is advisable to use a link shortener
                        or (if possible) to scan the QR code below.
                    </p>
                    <div class="grid">
                        <div>
                            <a href="" id="shareLink" target="_blank"></a>
                        </div>
                        <div>
                            <button id="copyLinkButton">Copy link</button>
                        </div>
                    </div>
                    <p>
                    </p>
                    <div id="qrcode"></div>
                </article>
                <details>
                    <summary role="button" class="outline secondary">Sync log</summary>
                    <article>
                        <small>
                            <div id="syncLog"></div>
                        </small>
                    </article>
                </details>
            </details>

        </article>

        <canvas id="threeCanvas"></canvas>

        <script src=" https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
        <script src="https://unpkg.com/peerjs@1.5.5/dist/peerjs.min.js"></script>
        <script src="src/main.js" type="module"></script>
    </body>
</html>
